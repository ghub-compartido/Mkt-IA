{% extends 'base.html' %}
{% block content %}
<section class="page-header">
    <div>
        <p class="eyebrow">Marketing Video Assist ‚Ä¢ Beta</p>
        <h1>Dashboard</h1>
        <p class="lead">Automatiza campa√±as y crea anuncios optimizados para TikTok, Instagram y YouTube.</p>
    </div>
    <button class="btn primary" onclick="openCampaignModal()">+ Nueva campa√±a</button>
</section>


<section class="panel stats">
    <div>
        <p class="eyebrow">Estad√≠sticas R√°pidas</p>
        <h4>Tiktok</h4>
        <div class="stat-row">
            <div>
                <span class="stat-value">84K</span>
                <p class="muted">Imp</p>
            </div>
            <div>
                <span class="stat-value">6.8%</span>
                <p class="muted">CTR</p>
            </div>
            <div>
                <span class="stat-value">43.2k</span>
                <p class="muted">Views</p>
            </div>
            <div>
                <span class="stat-value">12.3k</span>
                <p class="muted">Likes</p>
            </div>
        </div>
    </div>
    <div class="separator"></div>
    <div>
        <p class="eyebrow">Campa√±as Activas</p>
        <h2>125K</h2>
        <p class="muted">En las √∫ltimas 24h</p>
    </div>
</section>

<section class="panel">
    <div class="panel-header">
        <div>
            <p class="eyebrow">Mis Campa√±as</p>
            <h2>Campa√±as del trimestre</h2>
        </div>
        <div class="actions">
            <button class="btn secondary">Importar CSV</button>
            <button class="btn secondary">Filtros</button>
            <button class="btn primary" onclick="openCampaignModal()">+ Nueva Campa√±a</button>
        </div>
    </div>
    <div class="campaign-grid">
        {% for campaign in campaigns %}
        <article class="campaign-card">
            <div class="card-body">
                <button class="video-thumbnail-container" onclick="videoPreview.open('/{{ campaign.videoPath }}', '{{ campaign.title }}')" style="position: relative; width: 100%; height: 180px; background: #f0f0f0; border-radius: 8px; display: flex; align-items: center; justify-content: center; border: none; cursor: pointer; transition: all 0.3s;">
                    <span style="font-size: 48px;">‚ñ∂Ô∏è</span>
                </button>
                <h4 style="margin-top: 12px;">{{ campaign.title }}</h4>
                <p class="muted">{{ campaign.platforms | join(', ') }}</p>
                <div style="display: flex; gap: 8px; margin-top: 8px; font-size: 11px; color: #666;">
                    <span>üìê {{ campaign.resolution }}</span>
                    <span>‚è±Ô∏è {{ campaign.duration }}</span>
                    <span>üìπ {{ campaign.format }}</span>
                </div>
            </div>
            <footer class="card-footer">
                <div class="pill neutral">{{ campaign.status }}</div>
                <div class="pill">{{ campaign.views }} vistas</div>
                <div class="pill">{{ campaign.likes }} likes</div>
            </footer>
        </article>
        {% endfor %}
    </div>
</section>

<!-- Modal for Create Campaign -->
<div id="campaignModal" class="modal-overlay">
    <div class="modal-content">
        <button class="modal-close" onclick="closeCampaignModal()">√ó</button>
        <div style="padding: 24px;">
            <!-- Header -->
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 32px;">
                <div>
                    <p class="eyebrow">Configura tu nueva campa√±a de video</p>
                    <h2 style="margin: 8px 0;">Create New Campaign</h2>
                </div>
            </div>

            <!-- Basic Information -->
            <section class="panel" style="margin-bottom: 24px;">
                <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">Basic Information</h3>
                
                <div style="margin-top: 20px;">
                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 8px; color: #333;">Campaign Name</label>
                    <input id="campaignName" type="text" placeholder="Enter campaign name" style="width: 100%; padding: 10px 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px; outline: none;">
                </div>

                <div style="margin-top: 16px;">
                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 8px; color: #333;">Prompt</label>
                    <textarea id="campaignDescription" placeholder="Describe your campaign objectives..." rows="3" style="width: 100%; padding: 10px 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px; outline: none; resize: vertical; font-family: inherit;"></textarea>
                </div>
            </section>

            <!-- Video Format -->
            <section class="panel" style="margin-bottom: 24px;">
                <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">Video Format</h3>
                <p style="font-size: 13px; color: #666; margin-bottom: 20px;">Select the type of video content for your campaign.</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                    <label class="video-format-option" style="display: flex; align-items: flex-start; gap: 12px; padding: 16px; border: 2px solid #E0E0E0; border-radius: 12px; cursor: pointer; background: white; transition: all 0.2s;">
                        <input type="radio" name="videoFormat" checked style="margin-top: 2px;">
                        <div>
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                <span style="font-size: 18px;">‚ö°</span>
                                <strong class="option-title" style="font-size: 14px;">Short Videos</strong>
                            </div>
                            <p style="font-size: 12px; color: #666; margin: 0;">Quick, engaging content for maximum reach</p>
                            <div style="display: flex; gap: 6px; margin-top: 8px;">
                                <span class="badge" style="font-size: 11px; padding: 2px 8px; background: #F5F5F5; border-radius: 4px; color: #666;">15-60s</span>
                                <span class="badge" style="font-size: 11px; padding: 2px 8px; background: #F5F5F5; border-radius: 4px; color: #666;">Vertical</span>
                            </div>
                        </div>
                    </label>

                    <label class="video-format-option" style="display: flex; align-items: flex-start; gap: 12px; padding: 16px; border: 2px solid #E0E0E0; border-radius: 12px; cursor: pointer; background: white; transition: all 0.2s;">
                        <input type="radio" name="videoFormat" style="margin-top: 2px;">
                        <div>
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                <span style="font-size: 18px;">‚ñ∂Ô∏è</span>
                                <strong class="option-title" style="font-size: 14px;">Long Videos</strong>
                            </div>
                            <p style="font-size: 12px; color: #666; margin: 0;">In-depth content for detailed storytelling</p>
                            <div style="display: flex; gap: 6px; margin-top: 8px;">
                                <span class="badge" style="font-size: 11px; padding: 2px 8px; background: #F5F5F5; border-radius: 4px; color: #666;">1-30min</span>
                                <span class="badge" style="font-size: 11px; padding: 2px 8px; background: #F5F5F5; border-radius: 4px; color: #666;">Horizontal</span>
                            </div>
                        </div>
                    </label>
                </div>
            </section>

            <!-- Video Duration -->
            <section class="panel" style="margin-bottom: 24px;">
                <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">Video Duration</h3>
                <p style="font-size: 13px; color: #666; margin-bottom: 16px;">Choose the length of your video content</p>
                
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;">
                    <button class="duration-btn" data-duration="15" style="padding: 12px; border: 2px solid #7C3AED; border-radius: 8px; background: #F5F3FF; cursor: pointer; text-align: center; transition: all 0.2s;">
                        <div class="duration-title" style="font-size: 18px; font-weight: 600; color: #7C3AED;">15s</div>
                        <div style="font-size: 11px; color: #666; margin-top: 2px;">Quick Clip</div>
                    </button>
                    <button class="duration-btn" data-duration="30" style="padding: 12px; border: 2px solid #E0E0E0; border-radius: 8px; background: white; cursor: pointer; text-align: center; transition: all 0.2s;">
                        <div class="duration-title" style="font-size: 18px; font-weight: 600; color: #333;">30s</div>
                        <div style="font-size: 11px; color: #666; margin-top: 2px;">Standard</div>
                    </button>
                    <button class="duration-btn" data-duration="60" style="padding: 12px; border: 2px solid #E0E0E0; border-radius: 8px; background: white; cursor: pointer; text-align: center; transition: all 0.2s;">
                        <div class="duration-title" style="font-size: 18px; font-weight: 600; color: #333;">60s</div>
                        <div style="font-size: 11px; color: #666; margin-top: 2px;">Extended</div>
                    </button>
                    <button class="duration-btn custom-btn" data-duration="custom" style="padding: 12px; border: 2px solid #E0E0E0; border-radius: 8px; background: white; cursor: pointer; text-align: center; transition: all 0.2s;">
                        <div class="duration-title" style="font-size: 18px; font-weight: 600; color: #333;">Custom</div>
                        <div style="font-size: 11px; color: #666; margin-top: 2px;">Your Choice</div>
                    </button>
                </div>
                
                <!-- Custom Duration Input -->
                <div id="customDurationInput" style="display: none; margin-top: 16px; padding: 16px; background: #F5F3FF; border: 2px solid #7C3AED; border-radius: 8px;">
                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 8px; color: #333;">Enter custom duration (seconds)</label>
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <input id="customSeconds" type="number" min="4" max="60" placeholder="4-60" style="flex: 1; padding: 8px 12px; border: 1px solid #7C3AED; border-radius: 6px; font-size: 14px; outline: none;">
                        <span style="font-size: 14px; color: #666;">seconds</span>
                    </div>
                    <p style="font-size: 11px; color: #666; margin: 8px 0 0 0;">üí° Sora accepts videos between 4 and 60 seconds</p>
                </div>
            </section>

            <!-- Video Resolution -->
            <section class="panel" style="margin-bottom: 24px;">
                <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">Video Resolution</h3>
                <p style="font-size: 13px; color: #666; margin-bottom: 16px;">Select the quality of your video output</p>
                
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;">
                    <button class="resolution-btn" data-resolution="720p" style="padding: 16px; border: 2px solid #E0E0E0; border-radius: 8px; background: white; cursor: pointer; text-align: center; transition: all 0.2s;">
                        <div class="resolution-title" style="font-size: 20px; font-weight: 600; color: #333; margin-bottom: 4px;">720p</div>
                        <div style="font-size: 11px; color: #666; margin-bottom: 4px;">HD</div>
                        <div style="font-size: 10px; color: #999;">1280 √ó 720</div>
                        <div style="font-size: 10px; color: #999; margin-top: 4px;">üíª Horizontal</div>
                    </button>
                    <button class="resolution-btn" data-resolution="720x1280" style="padding: 16px; border: 2px solid #7C3AED; border-radius: 8px; background: #F5F3FF; cursor: pointer; text-align: center; position: relative; transition: all 0.2s;">
                        <span style="position: absolute; top: 8px; right: 8px; font-size: 10px; padding: 2px 8px; background: #7C3AED; color: white; border-radius: 4px; font-weight: 600;">Vertical</span>
                        <div class="resolution-title" style="font-size: 20px; font-weight: 600; color: #7C3AED; margin-bottom: 4px;">720x1280</div>
                        <div style="font-size: 11px; color: #666; margin-bottom: 4px;">HD Vertical</div>
                        <div style="font-size: 10px; color: #999;">720 √ó 1280</div>
                        <div style="font-size: 10px; color: #999; margin-top: 4px;">‚úÖ Recommended</div>
                    </button>
                    <button class="resolution-btn" data-resolution="1080p" style="padding: 16px; border: 2px solid #E0E0E0; border-radius: 8px; background: white; cursor: pointer; text-align: center; position: relative; transition: all 0.2s;">
                        <span style="position: absolute; top: 8px; right: 8px; font-size: 10px; padding: 2px 8px; background: #7C3AED; color: white; border-radius: 4px; font-weight: 600;">Full HD</span>
                        <div class="resolution-title" style="font-size: 20px; font-weight: 600; color: #333; margin-bottom: 4px;">1080p</div>
                        <div style="font-size: 11px; color: #666; margin-bottom: 4px;">Full HD</div>
                        <div style="font-size: 10px; color: #999;">1920 √ó 1080</div>
                        <div style="font-size: 10px; color: #999; margin-top: 4px;">üíª Horizontal</div>
                    </button>
                    <button class="resolution-btn" data-resolution="4k" style="padding: 16px; border: 2px solid #E0E0E0; border-radius: 8px; background: white; cursor: pointer; text-align: center; position: relative; transition: all 0.2s;">
                        <span style="position: absolute; top: 8px; right: 8px; font-size: 10px; padding: 2px 8px; background: #7C3AED; color: white; border-radius: 4px; font-weight: 600;">Ultra HD</span>
                        <div class="resolution-title" style="font-size: 20px; font-weight: 600; color: #333; margin-bottom: 4px;">4K</div>
                        <div style="font-size: 11px; color: #666; margin-bottom: 4px;">Ultra HD</div>
                        <div style="font-size: 10px; color: #999;">3840 √ó 2160</div>
                        <div style="font-size: 10px; color: #999; margin-top: 4px;">‚≠ê Premium</div>
                    </button>
                </div>
            </section>

            <!-- Publishing Platforms -->
            <section class="panel" style="margin-bottom: 24px;">
                <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">Publishing Platforms</h3>
                <p style="font-size: 13px; color: #666; margin-bottom: 16px;">Select where you want to publish your campaign</p>
                
                <div style="display: flex; gap: 16px; align-items: center; justify-content: center;">
                    <label style="display: flex; flex-direction: column; align-items: center; cursor: pointer; position: relative;">
                        <input type="checkbox" style="position: absolute; top: -5px; right: -5px; width: 20px; height: 20px; cursor: pointer;">
                        <div style="width: 64px; height: 64px; background: linear-gradient(45deg, #F58529, #DD2A7B, #8134AF, #515BD4); border-radius: 16px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                            <span style="font-size: 32px; color: white;">üì∑</span>
                        </div>
                        <strong style="font-size: 12px; margin-top: 8px; color: #333;">Instagram</strong>
                    </label>

                    <label style="display: flex; flex-direction: column; align-items: center; cursor: pointer; position: relative;">
                        <input type="checkbox" style="position: absolute; top: -5px; right: -5px; width: 20px; height: 20px; cursor: pointer;">
                        <div style="width: 64px; height: 64px; background: #000000; border-radius: 16px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                            <span style="font-size: 32px;">üéµ</span>
                        </div>
                        <strong style="font-size: 12px; margin-top: 8px; color: #333;">TikTok</strong>
                    </label>

                    <label style="display: flex; flex-direction: column; align-items: center; cursor: pointer; position: relative;">
                        <input type="checkbox" style="position: absolute; top: -5px; right: -5px; width: 20px; height: 20px; cursor: pointer;">
                        <div style="width: 64px; height: 64px; background: #FF0000; border-radius: 16px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                            <span style="font-size: 32px; color: white;">‚ñ∂Ô∏è</span>
                        </div>
                        <strong style="font-size: 12px; margin-top: 8px; color: #333;">YouTube</strong>
                    </label>
                </div>
                        <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                            <span style="font-size: 10px; padding: 2px 6px; background: #F5F5F5; border-radius: 4px; color: #666;">16:9</span>
                            <span style="font-size: 10px; padding: 2px 6px; background: #F5F5F5; border-radius: 4px; color: #666;">9:16</span>
                        </div>
                    </label>
                </div>

                <div style="margin-top: 16px; padding: 12px; background: #EEF2FF; border-left: 3px solid #7C3AED; border-radius: 6px; font-size: 13px; color: #333;">
                    <span style="color: #7C3AED;">‚ÑπÔ∏è</span> <strong>Platform Optimization</strong> Videos will be automatically optimized for each selected platform's requirements and best practices.
                </div>
            </section>

            <!-- Test Mode -->
            <section class="panel" style="margin-bottom: 24px; background: #FFF3E0; border: 2px solid #FF9800;">
                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                    <input type="checkbox" id="testMode" style="width: 20px; height: 20px; cursor: pointer;">
                    <div>
                        <div style="font-size: 14px; font-weight: 600; color: #E65100;">üß™ Modo Prueba (Test Mode)</div>
                        <div style="font-size: 12px; color: #666; margin-top: 4px;">Usar primer video de videos-sora/ en lugar de generar nuevo (ahorra tiempo y API calls)</div>
                    </div>
                </label>
            </section>

            <!-- Create Campaign Button -->
            <div style="display: flex; justify-content: center; gap: 12px; margin-top: 32px; margin-bottom: 16px;">
                <button class="btn secondary" onclick="closeCampaignModal()">Cancel</button>
                <button class="btn primary" onclick="createCampaign()" style="padding: 14px 32px; font-size: 16px; font-weight: 600;">Create Campaign ‚Üí</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
